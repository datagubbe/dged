#!/bin/sh

echo "/* Generated by configure */" > src/config.h
echo "#ifndef _CONFIG_H" >> src/config.h
echo "#define _CONFIG_H" >> src/config.h

echo "# generated by configure" > config.mk

echo -n "detecting event system... "
if ./scripts/has_header "sys/epoll.h"; then
    echo "epoll."
    echo "#define HAS_EPOLL 1" >> src/config.h
    echo "HAS_EPOLL ?= true" >> config.mk
elif ./scripts/has_header "sys/event.h"; then
    echo "kqueue."
    echo "#define HAS_KQUEUE 1" >> src/config.h
    echo "HAS_KQUEUE ?= true" >> config.mk
else
    echo "none."
fi

echo "#endif" >> src/config.h
echo "wrote src/config.h"
echo "wrote config.mk"
